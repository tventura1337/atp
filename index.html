<!DOCTYPE html>
<html>
<head>
	<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
	<script src="autocomplete/jquery.easy-autocomplete.min.js"></script> 
	<link rel="stylesheet" href="autocomplete/easy-autocomplete.min.css"> 
	<style>


	/* When the body has the loading class, we turn
	   the scrollbar off with overflow:hidden */
	.loading {
		display: none;
		border: 8px solid #f3f3f3;
		border-top: 8px solid #434343;
		border-radius: 50%;
		width: 80px;
		height: 80px;
		animation: spin 1s linear infinite;
		z-index: 1;
		margin-bottom: 9999px;
	}
	@keyframes spin {
	    0% { transform: rotate(0deg); }
	    100% { transform: rotate(360deg); }
	}

	</style>
</head>
<body>
	<div class="loading"></div>
	<section>
		<h1>Air Planner</h1>
		<div style="width: 150px;">
		<input id="src" placeholder="Source AP"/>
		<input id="destination" placeholder="Destinationa AP"/>
		<div>
		<button class="find">Calculate</button>
	</section>
	<script>
		$(document).ajaxStart(function () {
		    $(".loading").show();
		}).ajaxComplete(function () {
		   $(".loading").hide();
		});
		
		get_airports();
		
		function callback_return_optimal(response){
			console.log(response);
		}

		function get_airports() {
			$.ajax({
				type: "GET",
				url: "http://flowmaster.org:8888/airports/",
				//data: { param: input },
				success: callback_get_airports
				});
		}

		function callback_get_airports(response) {
			// do something with the response
			var data = response["data"]
			var status = response["status"]
			var options = {
				data: data,
				getValue: "name",
				list: {
					match: {
						enabled: true
					}
				}
	
			};

			$("#src").easyAutocomplete(options);
			$("#destination").easyAutocomplete(options);
		}
		
		function find_optimal_routes(){
			var source = $("#src").val();
			var destination = $("#destination").val();
			source = source.split(' - ');
			destination = destination.split(' - ');
			request = "http://flowmaster.org:8888/optimal/"+source[source.length-1]+"/"+destination[destination.length-1]+"/";
			console.log(request)
			$.ajax({
				type: "GET",
				url: request,
				success: callback_return_optimal
			});
		}

		$(".find").click(function(){
			find_optimal_routes();
		});
		
			
	</script>
</body>
</html>